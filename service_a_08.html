<html lang="zh-cn">

<head>
  <meta charset="utf-8">
  <title>度量云开发_批量压力监测数据清洗</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="智态供水智能云平台,供水管网,WaterETMS,智态云,上海智态数据科技有限公司,事件预警平台,数据预测,数据清洗,趋势与噪声,水力模型,智能,压力监测点,分区计量,社区">
  <meta name="description" content="">
  <link rel="shortcut icon" href="images/logo/logo.jpg">
  <link href="css/index_129ec4d.css" rel="stylesheet">
  <link href="css/table_d131dbe.css" rel="stylesheet">
  <link href="css/jquery-accordion-menu.css" rel="stylesheet">
  <!--  导航条引用  -->
  <link rel="stylesheet" href="css/common.bundle.style.css">
  <script src="http://push.zhanzhang.baidu.com/push.js"></script>
  <script src="https://hm.baidu.com/hm.js?fdad4351b2e90e0f489d7fbfc47c8acf"></script>
  <script src="Scripts/json2.js" type="text/javascript"></script>

  <script src="Scripts/ServiceJS.js" type="text/javascript"></script>

  <!-- 
  <script src="js/02.js" type="text/javascript"></script> -->
  <!-- <script src="js/01.js" type="text/javascript"></script> -->



  <style>
    #C
        {
            clear: both;
        }
        
        #C a
        {
            padding: 8px;
            display: none;
        }
        
        #li1:hover a
        {
            display: block;
        }
        
        #ceshi2 li
        {
            list-style: none;
        }
    </style>
  <!--  导航条引用  -->
</head>

<body class="ai-platform">

  <div id="classContent">
    <!--  数据清洗  -->
    <h2 id="b0">
      批量压力监测数据清洗</h2>
    <div class="class_item" id="c0b0">
      <div class="class_title">
        概述</div>
      <div class="class_desc">
        批量压力监测数据清洗是对一段时间的压力监测数据进行清洗，删除明显超出正常范围的数据，对短时间的缺失数据进行补充，如果长时间数据缺失，不对其进行补充。<br />
        历史窗口压力监测数据清洗主要用于监测数据趋势分析、监测数据相似性分析等功能的前期数据处理。</div>

      <div class="class_desc" style="width: 954px; height: auto; background: none; padding-left: 0px;">
        <img src="images/service/service_piliangyaliqingxi.png" alt="" style="max-width: 100%;" />

      </div>
      <div class="class_desc">
        单个时刻压力监测数据清洗与历史窗口压力监测数据清洗的对比见下表:
      </div>
      <table class="table table-bordered class_proper">
        <tbody>
          <tr class="class_proper_header hide">
            <td colspan="3">
              属性
            </td>
          </tr>
          <tr class="class_proper_header">
            <td>
              单个时刻压力监测数据清洗
            </td>
            <td>
              历史窗口压力监测数据清洗
            </td>
          </tr>
          <tr class="class_proper_content">
            <td>
              每次计算清洗一个时间点的数据
            </td>
            <td>
              对所有输入的历史数据进行清洗
            </td>
          </tr>
          <tr class="class_proper_content" style="background: #ffffff;">
            <td>
              输出数据状态：正常、缺失或异常
            </td>
            <td>
              不输出数据状态
            </td>
          </tr>
          <tr class="class_proper_content">
            <td>
              数据缺失时，根据历史数据规律对其进行补充
            </td>
            <td>
              对短时间的数据缺失进行补充，如果长时间数据缺失，不对其进行补充
            </td>
          </tr>

        </tbody>
      </table>
    </div>
    <div class="class_item" id="c0b1">
      <div class="class_title">
        端口调用</div>
      <div class="class_desc">
        网址 <a href="http://112.64.170.158:9100/api/Windowwashp/Window_wash_p " style="color: #349df0; font-style: italic;
                            font-weight: bold; text-decoration: underline;">
          <span style="color: #349df0; font-style: italic; font-weight: bold;">http://112.64.170.158:9100/api/Windowwashp
          </span>
        </a>
      </div>
      <div class="class_desc">
        方法名 <span style="color: #349df0; font-style: italic; font-weight: bold;">Window_wash_p
        </span>
      </div>
      <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
        输入参数</div>
      <div class="class_title" style="color: #349df0; font-size: 16px; font-weight: bold;
                        margin-top: 40px; line-height: 60px;">
      </div>
      <table class="table table-bordered class_proper">
        <tbody>
          <tr class="class_proper_header hide">
            <td colspan="3">
              属性
            </td>
          </tr>
          <tr class="class_proper_header">
            <td>
              变量名称
            </td>
            <td>
              含义
            </td>
            <td>
              维度
            </td>
            <td>
              备注
            </td>
          </tr>
          <tr class="class_proper_content">
            <td>
              History_window_in
            </td>
            <td>
              输入历史窗口
            </td>
            <td>
              N*1
            </td>
            <td>
              可以取任意长一段时间的历史数据
            </td>
          </tr>
          <tr class="class_proper_content" style="background: #ffffff;">
            <td>
              Day_count
            </td>
            <td>
              历史窗口数据天数
            </td>
            <td>
              1*1
            </td>
            <td>

            </td>
          </tr>
          <tr class="class_proper_content">
            <td>
              Tolerance
            </td>
            <td>
              容差
            </td>
            <td>
              1*1
            </td>
            <td>
              建议取值[0.01,0.03]
            </td>
          </tr>
        </tbody>
      </table>
      <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
        输入的json格式为：</div>
      <div class="class_title" style="font-size: 14px; font-weight: bold; margin-top: 40px;
                        letter-spacing: 2;">
      </div>
      <!--<div class="class_desc" style="width: 954px; height: auto; background: #30363e; padding-left: 20px;">
                        <p style="line-height: 20px;">
                            {</p>
                        <br>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"Day_count"</span> : <span style="color: #aeb454;">3</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"History_window"</span> :[ <span style="color: #96bad6;">
                                157</span> , <span style="color: #96bad6;">141</span> ...... ]
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"Step_n"</span> : <span style="color: #aeb454;">4</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"Tolerance"</span> : <span style="color: #aeb454;">500</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"Val_max"</span> : <span style="color: #aeb454;">99999</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"Val_min"</span> : <span style="color: #aeb454;">-99999</span>
                            ,
                        </p>
                        <br>
                        <p style="line-height: 20px;">
                            }</p>
                    </div>-->
      <textarea class="class_desc" type="text" style="width: 954px; height: 240px; background: #30363e;
                            padding: 10px; color: #96bad6;"
        readonly="readonly">
  {
        "Day_count" : 3 , 
        "History_window" :[  157 , 141 ...... ] ,
        "tolerance":0.03
     }
						 </textarea>
      <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
        输出参数</div>
      <div class="class_title" style="color: #349df0; font-size: 16px; font-weight: bold;
                        margin-top: 40px; line-height: 60px;">
      </div>
      <table class="table table-bordered class_proper">
        <tbody>
          <tr class="class_proper_header hide">
            <td colspan="3">
              属性
            </td>
          </tr>
          <tr class="class_proper_header">
            <td>
              变量名称
            </td>
            <td>
              含义
            </td>
            <td>
              维度
            </td>
            <td>
              备注
            </td>
          </tr>
          <tr class="class_proper_content" style="background: #ffffff;">
            <td>
              History_window_out
            </td>
            <td>
              输出历史窗口
            </td>
            <td>
              N*1
            </td>
            <td>

            </td>
          </tr>

        </tbody>
      </table>

      <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
        输出的json格式为：</div>
      <div class="class_title" style="font-size: 14px; font-weight: bold; margin-top: 40px;
                        letter-spacing: 2;">
      </div>
      <!-- <div class="class_desc" style="width: 954px; height: auto; background: #30363e; padding-left: 20px;">
                        <p style="line-height: 20px;">
                            {</p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"ErrorCode"</span>:<span style="color: #aeb454;">0</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"ErrorMessage"</span>:<span style="color: #aeb454;"></span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            <span style="color: #96bad6;">"RData"</span>:</p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            [</p>
                        <p style="line-height: 20px; padding-left: 40px;">
                            {
                        </p>
                        <p style="line-height: 20px; padding-left: 60px;">
                            <span style="color: #96bad6;">"Data_out"</span>:<span style="color: #aeb454;">224</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 60px;">
                            <span style="color: #96bad6;">"ErrorCode"</span>:<span style="color: #aeb454;">0</span>
                            ,
                        </p>
                        <p style="line-height: 20px; padding-left: 40px;">
                            }
                        </p>
                        <p style="line-height: 20px; padding-left: 20px;">
                            ]</p>
                        <br>
                        <br>
                        <p style="line-height: 20px;">
                            }</p>
                    </div>-->
      <textarea class="class_desc" type="text" style="width: 954px; height: 200; background: #30363e;
                            padding: 10px; color: #96bad6;"
        readonly="readonly">
{
      "History_window_out":[157,141,.......]
}
					</textarea>






    </div>
    <!--  数据清洗 -->
    <!--数据清洗代码调试区-->
    <div class="class_item" id="c0b2">
      <div class="class_title">
        在线测试</div>
      <form>
        <div class="tiaoshi_head">
          <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
            编辑您的代码：</div>
          <textarea id="demo" class="class_desc" type="text" style="width: 954px; height: 480px; background: #30363e;
                            padding: 10px; color: #96bad6;"
            id="Textarea">
{"Day_count":1,"tolerance":0.03,"History_window_in":[0.383437,0.385625,0.383437,0.3925,0.390937,0.395313,0.393437,0.394375,0.393437,0.366563,0.37125,0.367812,0.373437,0,0.373437,0.33125,0.332188,0.33125,0.338438,0.335938,0.345938,0.340938,0.344062,0.340938,0.34875,0.34375,0.344687,0.353125,0.34875,0.353125,0.345938,0.34875,0.347187,0.346875,0.347813,0.346875,0.349375,0.348438,0.347813,0,0.35125,0.350938,0.356875,0.354063,0.350625,0.349062,0.34875,0.349062,0.345,0.349375,0.353438,0.350938,0.346562,0.350938,0.349687,0.349687,0.34875,0.341875,0.36125,0.341875,0.358438,0.36375,0.366875,0.360312,0,0.360312,0.369375,0.36375,0.36875,0.361875,0.359375,0.361875,0.360625,0.357812,0.345313,0.385313,0.391875,0.,0.390313,0.391875,0.395937,0,0.39,0.398438,0.3775,0.38375,0.368125,0.355312,0.353125,0.355312,0.385313,0.385937,0.369375,0.347187,0.368437,0.347187,0.364687,0.362187,0.38125,0.378125,0.377188,0.369063,0.370937,0.369375,0.351563,0.359687,0.347813,0.359687,0.339687,0.339375,0.34375,0.340938,0.341875,0.340938,0.344375,0.343438,0,0.346875,0.34625,0.346875,0.2875,0.28875,0.27625,0.270625,0.26875,0.270625,0.269062,0.273438,0.267813,0.265,0.259375,0.265,0.263125,0.264062,0.261875,0.26125,0.2625,0.26125,0.264688,0.2675,0.321875,0.330937,0.335313,0,0.400313,0.396875,0.403438,0.398438,0.402813,0.383437,0.385625,0.383437,0.3925,0.390937,0.395313,0.393437,0.394375,0.393437,0.366563,0.37125,0.367812,0.373437,0.338125,0.373437,0.33125,0.332188,0.33125,0.338438,0.335938,0.345938,0.340938,0.344062,0.340938,0.34875,0.34375,0.344687,0.353125,0.34875,0.353125,0.345938,0.34875,0.347187,0,0.347813,0.346875,0.349375,0.348438,0.347813,0.350938,0.35125,0.350938,0.356875,0.354063,0.350625,0.349062,0.34875,0.349062,0.345,0.349375,0.353438,0.350938,0.346562,0.350938,0.349687,0.349687,0.34875,0.341875,0.36125,0.341875,0.358438,0.36375,0.366875,0.360312,0.36375,0.360312,0.369375,0.36375,0.36875,0.361875,0.359375,0.361875,0.360625,0,0.345313,0.385313,0.391875,0.385313,0.383437,0.385625,0.383437,0.3925,0.390937,0.395313,0.393437,0.394375,0.393437,0.366563,0.37125,0.367812,0.373437,0.338125,0.373437,0.33125,0.332188,0.33125,0.338438,0.335938,0.345938,0.340938,0.344062,0.340938,0.34875,0.34375,0.344687,0.353125,0.34875,0.353125,0.345938,0.34875,0.347187,0.346875,0.347813,0.346875,0.349375,0.348438,0.347813,0.350938,0.35125,0.350938,0.356875,0.354063,0.350625,0.349062,0.34875,0.349062,0.345,0.349375,0.353438,0.350938,0.346562,0.350938,0.349687,0.349687,0.34875,0.341875,0.36125,0.341875,0.358438,0.36375,0.366875,0.360312,0.36375,0.360312,0.369375,0.36375,0.36875,0.361875,0.359375,0,0.360625,0.357812,0.345313,0.385313,0.391875,0.385313]}
						 </textarea>
          <div class="tiaoshi_head02">
            <button id="echart" type="button" onmouseover="this.style.Color='#0073eb';" class="tiaoshi_head02_btn">
              点击运行</button>
          </div>
        </div>
      </form>
      <div class="class_title" style="height: 40px;">
      </div>
      <div class="class_title" style="font-size: 16px; font-weight: bold; margin-top: 40px;">
        运行结果：</div>
      <textarea class="class_desc" type="text" style="width: 954px; height: 480px; background: #30363e;
                        padding: 10px; color: #96bad6;"
        id="Textarea1">
 { TimeStamp : Flow }, { TimeStamp :  Flow }, { TimeStamp :  Flow }, ...... 
					</textarea>
    </div>
    <!--数据清洗代码调试区-->
    <div id="main" style="width: 1140px; height: 480px;margin: 0 0px 0 -68px">
    </div>
    <div style="width: 954px; height: 300px;">
    </div>
  </div>

</body>
<!-- ECharts单文件引入 -->
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
<script>
  //var str = document.getElementById("demo").value;
  var v = '';

  var echart = document.getElementById("echart").addEventListener("click",
    function run() {
      //获取前台输入数据
      //var str = document.getElementById("Textarea").value;
      var str = document.getElementById("demo").value;
      console.log(str)
      var st = str.replace(/\"/g, "\\\"")

      function trim(st) { //删除左右两端的空格

        return t0 = st.replace(/(^\s*)|(\s*$)/g, "");
      }
      trim(st)
      console.log(st)
      console.log(t0)

      function strToJson(str) {
        var json = eval('(' + str + ')');
        return json
      }
      json = strToJson(str)
      console.log(json)
      arr = json.History_window_in
      console.log(arr)
      var v;
      //获取后台数据
      //var b = []; //流量（实际用来盛放Y坐标值）
      $.ajax({
        type: "POST",
        contentType: "application/json",
        async: false, //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
        url: "http://112.64.170.158:9100/api/Windowwashp/Window_wash_p", //请求发送到TestServlet处
        /*   data: "{Json:'" + t0 + "'}", */
        data: str,
        dataType: "json", //返回数据形式为json
        success: function getnum(result) {

          v = result.History_window_out
          $('#Textarea1').val("{" + '"History_window_out"' + ":" + "[" + v + "]" + "}");

        },
        error: function (errorMsg) {
          //请求失败时执行该函数
          console.log(errorMsg)
          alert("sorry，请求后台数据失败!");
          myChart.hideLoading();
        }
      })
      //前后台数据整合
      cc = arr.concat(v),
        d = arr.length;
      e = [];
      for (var i = 0; i < arr.length; i++) {
        e.push(i)
      }
      e2 = [];
      for (var i = 0; i < v.length; i++) {
        e2.push(i)
      }
      //初始化Echarts
      var myChart = echarts.init(document.getElementById('main'));
      // 指定图表的配置项和数据
      var option = {
        title: {
          text: '批量压力监测数据清洗',
          padding: [0, 0, 4, 68],
        },
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'cross'
          }
        },
        legend: {
          data: ['历史数据', '清洗后数据']
        },
        xAxis: {
          type: 'category',
          boundaryGap: false,
          data: e
        },
        yAxis: {
          type: 'value',
          //splitLine: { show: false },//去除网格线
          axisLabel: {
            formatter: '{value}'
          },
          axisPointer: {
            snap: true
          },
          name: 'Mpa',
          /* splitNumber: '4', */
          //splitLine: { show: false },//去除网格线
          axisLabel: {
            formatter: '{value}'
          },
          axisPointer: {
            snap: true
          },
          nameGap: '8',
          nameTextStyle: {
            align: 'center',
            verticalAlign: 'top',
            color: 'black',
            padding: [33, 6, 4, 0],
            shadowOffsety: 6,
            fontFamily: 'Microsoft YaHei',
            /* fontWeight: 'bold', */
            /* fontStyle: 'italic' */

          },
        },
        series: [{
            name: '清洗后数据',
            type: 'line',
            smooth: true,
            /* areaStyle: {
            normal: {}
            }, */
            symbol: 'triangle',
            symbolSize: 60,
            itemStyle: {
              normal: {
                borderWidth: 3,
                borderColor: 'yellow',
                color: 'green',
                opacity: 0.3
              }
            },
            data: v,
            symbol: 'roundRect',
            symbolSize: 1,
          },
          {
            name: '历史数据',
            type: 'line',
            smooth: true,
            areaStyle: {},
            data: arr,
            symbol: 'roundRect',
            symbolSize: 0.1,
            /* areaStyle: {
            normal: {
            color: 'red',
            opacity: 0.3
            }
            }, */
            itemStyle: {
              normal: {
                lineStyle: {
                  width: 1.5, //折线宽度
                  color: "red", //折线颜色
                  opacity: 0.8
                }
              }
            },
          },

        ]
      };


      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option);

    });

</script>

</html>
